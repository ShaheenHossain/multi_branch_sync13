<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_job_cards">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <t t-foreach="docs" t-as="o">
                    <div class="page">
                        <t t-set="address">
                            <address t-field="o.partner_id" t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}' />
                            <div t-if="o.partner_id.vat" class="mt16">
                                <t t-if="o.company_id.country_id.vat_label" t-esc="o.company_id.country_id.vat_label" id="inv_tax_id_label"/>
                                <t t-else="">Tax ID</t>: <span t-field="o.partner_id.vat"/>
                            </div>
                        </t>
                        <h1>
                            <center><strong>
                                <span t-esc="o.name"/>
                            </strong> </center>
                        </h1>
                        <div id="informations" class="row mt32 mb32">
                            <div class="col-auto mw-100 mb-2" t-if="o.partner_id" name="partner_id">
                                <strong>Customer:</strong>
                                <p class="m-0" t-field="o.partner_id.name"/>
                            </div>
                            <div class="col-auto mw-100 mb-2" t-if="o.jobcard_date" name="jobcard_date">
                                <strong>Date:</strong>
                                <p class="m-0" t-field="o.jobcard_date"/>
                            </div>
                            <div class="col-auto mw-100 mb-2" t-if="o.company_id" name="company_id">
                                <strong>Company:</strong>
                                <p class="m-0" t-field="o.company_id.name"/>
                            </div>
                            <div class="col-auto mw-100 mb-2" t-if="o.branch_id" name="branch_id">
                                <strong>Branch:</strong>
                                <p class="m-0" t-field="o.branch_id.name"/>
                            </div>
                        </div>

                        <div>
                            <div style="float:left; width:50%">
                                <h2><strong>Product Info</strong></h2>
                                <div id="informations" class="row mt32 mb32">

                                    <div class="col-auto mw-100 mb-2" style="width:50%">
                                        <t t-if="o.product_id">
                                            <strong>Product:</strong>
                                            <p class="m-0" t-field="o.product_id.name"/>
                                        </t>
                                        <t t-if="o.item_description">
                                            <strong>Item Description:</strong>
                                            <p class="m-0" t-field="o.item_description"/>
                                        </t>
                                        <t t-if="o.serial_no">
                                            <strong>Serial No:</strong>
                                            <p class="m-0" t-field="o.serial_no"/>
                                        </t>
                                        <t>
                                            <strong>Item Sold Duration:</strong>
                                            <p>
                                                <span t-field="o.duration_month"/>Month <span t-field="o.duration_month"/>Year
                                            </p>
                                        </t>
                                    </div>
                                    <div class="col-auto mw-100 mb-2" style="width:50%">
                                        <t t-if="o.item_code">
                                            <strong>Item Code:</strong>
                                            <p class="m-0" t-field="o.item_code"/>
                                        </t>
                                        <t t-if="o.ref_no">
                                            <strong>Reference No:</strong>
                                            <p class="m-0" t-field="o.ref_no"/>
                                        </t>
                                        <t t-if="o.ref_no">
                                            <strong>Warehouse:</strong>
                                            <p class="m-0" t-field="o.warehouse_id.name"/>
                                        </t>
                                        <t t-if="o.hardware_type_id">
                                            <strong>Device Category:</strong>
                                            <p class="m-0" t-field="o.hardware_type_id.name"/>
                                        </t>
                                    </div>
                                </div>
                            </div>

                            <div style="float:right; width:50%">
                                <h2><strong>Warranty Info</strong></h2>
                                <div id="informations" class="row mt32 mb32">

                                    <div class="col-auto mw-100 mb-2" style="float:right; width:50%">
                                        <t t-if="o.warranty_type" name="warranty_type">
                                            <strong>Warranty Type:</strong>
                                            <p class="m-0" t-field="o.warranty_type"/>
                                        </t>
                                        <t t-if="o.warranty_type == 'out_of_warranty' and o.can_be_repaired" >
                                            <strong>Can Be Repaired?:</strong>
                                            <p class="m-0" t-field="o.can_be_repaired"/>
                                        </t>
                                        <t t-if="o.warranty_type == 'free_service' and o.warranty_type" >
                                            <strong>Warranty Approval Type:</strong>
                                            <p class="m-0" t-field="o.warranty_approval_type"/>
                                        </t>
                                        <t t-if="o.job_card_type == 'replace' and o.replacement_product_id">
                                            <strong>Replacement Product:</strong>
                                            <p class="m-0" t-field="o.replacement_product_id.name"/>
                                        </t>
                                    </div>
                                    <div class="col-auto mw-100 mb-2" style="width:50%">
                                        <t t-if="(o.warranty_type == 'free_service' or o.can_be_repaired) and o.job_card_type">
                                            <strong>Job Card Type:</strong>
                                            <p class="m-0" t-field="o.job_card_type"/>
                                        </t>
                                        <t t-if="o.job_card_type == 'replace' and o.replacement_type">
                                            <strong>Replacement Type:</strong>
                                            <p class="m-0" t-field="o.replacement_type"/>
                                        </t>
                                        <t t-if="o.job_card_type == 'replace' and o.sale_order_id">
                                            <strong>Sale Order:</strong>
                                            <p class="m-0" t-field="o.sale_order_id.name"/>
                                        </t>
                                        <t t-if="o.job_card_type == 'replace' and o.replacement_type in ['higher_no_fees', 'higher_with_fees'] and o.discount_product_id">
                                            <strong>Discount Product:</strong>
                                            <p class="m-0" t-field="o.replacement_product_id.name"/>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <h2><strong>Customer Complaints</strong></h2>
                        </div>
                        <div class="row mt32 mb32">
                            <div class="col-auto mw-100 mb-2">
                                <p class="m-0">
                                    <t t-if="o.white_screen">
                                        <img src="/maintenance_management/static/description/tick.svg" style="width: 15px;height: 15px;"/>
                                    </t>
                                    <t t-if="not o.white_screen">
                                        <img src="/maintenance_management/static/description/shapes-and-symbols.svg" style="width: 10px;height: 10px;"/>
                                    </t>
                                    White Screen
                                </p>
                            </div>
                            <div class="col-auto mw-100 mb-2">
                                <p class="m-0">
                                    <t t-if="o.touch_broken">
                                        <img src="/maintenance_management/static/description/tick.svg" style="width: 15px;height: 15px;"/>
                                    </t>
                                    <t t-if="not o.touch_broken">
                                        <img src="/maintenance_management/static/description/shapes-and-symbols.svg" style="width: 13px;height: 13px;"/>
                                    </t>
                                    Touch Broken
                                </p>
                            </div>
                            <div class="col-auto mw-100 mb-2">
                                <p class="m-0">
                                    <t t-if="o.no_voice">
                                        <img src="/maintenance_management/static/description/tick.svg" style="width: 15px;height: 15px;"/>
                                    </t>
                                    <t t-if="not o.no_voice">
                                        <img src="/maintenance_management/static/description/shapes-and-symbols.svg" style="width: 13px;height: 13px;"/>
                                    </t>
                                    No Voice
                                </p>
                            </div>
                            <div class="col-auto mw-100 mb-2">
                                <p class="m-0">
                                    <t t-if="o.bluetooth_not_working">
                                        <img src="/maintenance_management/static/description/tick.svg" style="width: 15px;height: 15px;"/>
                                    </t>
                                    <t t-if="not o.bluetooth_not_working">
                                        <img src="/maintenance_management/static/description/shapes-and-symbols.svg" style="width: 13px;height: 13px;"/>
                                    </t>
                                    Bluetooth Not Working
                                </p>
                            </div>
                            <div class="col-auto mw-100 mb-2">
                                <p class="m-0">
                                    <t t-if="o.other">
                                        <img src="/maintenance_management/static/description/tick.svg" style="width: 15px;height: 15px;"/>
                                    </t>
                                    <t t-if="not o.other">
                                        <img src="/maintenance_management/static/description/shapes-and-symbols.svg" style="width: 13px;height: 13px;"/>
                                    </t>
                                    Other -
                                    <t t-if="o.other" t-esc="o.complaint_description"/>
                                </p>
                            </div>
                        </div>

                        <div class="row">
                            <h2 t-if="o.workorder_lines"><strong>Work Order Lines</strong></h2>
                        </div>
                        <table class="table table-sm o_main_table" name="workorder_lines" t-if="o.workorder_lines">
                            <thead>
                                <tr>
                                    <t t-set="colspan" t-value="6"/>
                                    <th name="th_product" class="text-left"><span>Product</span></th>
                                    <th name="th_description" class="text-left"><span>Description</span></th>
                                    <th name="th_quantity" class="text-left"><span>Quantity</span></th>
                                    <th name="th_uom" class="text-left"><span>Unit of Measure</span></th>
                                    <th name="th_price_unit" class="text-right"><span>Price Unit</span></th>
                                    <th name="th_taxes" class="text-left"><span>Taxes</span></th>
                                    <th name="th_taxes" class="text-right"><span>VAT</span></th>
                                    <th name="th_sub_total" class="text-right"><span>Sub Total</span></th>
                                </tr>
                            </thead>
                            <tbody class="invoice_tbody">
                                 <t t-foreach="o.workorder_lines" t-as="line">
                                    <tr t-att-class="'bg-200 font-weight-bold o_line_section'">
                                        <td><span t-field="line.product_id.name" t-options="{'widget': 'text'}"/></td>
                                        <td><span t-field="line.name" t-options="{'widget': 'text'}"/></td>
                                        <td class="text-right" ><span t-field="line.quantity" t-options="{'widget': 'text'}"/></td>
                                        <td><span t-field="line.uom_id.name" t-options="{'widget': 'text'}"/></td>
                                        <td><span t-field="line.price_unit" /></td>
                                        <td t-attf-class="text-left {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                            <span t-esc="', '.join(map(lambda x: (x.description or x.name), line.tax_ids))" id="line_tax_ids"/>
                                        </td>
                                        <td class="text-right"><span t-field="line.tax_amount" /></td>
                                        <td class="text-right o_price_total"><span t-field="line.sub_total" /></td>
                                     </tr>
                                 </t>
                            </tbody>
                        </table>

                    </div>
                </t>
            </t>
        </t>
    </template>
    <report
        id="action_report_job_cards"
        model="helpdesk.ticket"
        string="Job Cards"
        report_type="qweb-pdf"
        name="maintenance_management.report_job_cards"
        file="maintenance_management.report_job_cards"
        />
</odoo>